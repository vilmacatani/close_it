<div>
   <%= render 'calendar' %>
</div>
<div class="container-dashboard">
  <div class="requests">
    <h3>Requests I've received</h3>
    <% counter = 0 %>
    <% @my_connection_requests_received.each do |request| %>
      <% counter += 1 %>
      <p>Company name: <%= User.where(id:request.sender_id).select(:company_name).first.company_name %></p>
      <% if request.pending == true %>
      <div class="forms-container">
        <%= render 'connections/accept', request: request, counter: counter %>
        <%= render 'connections/decline', request: request, counter: counter %>
      </div>
      <% else %>
        <% if request.pending == false && request.accepted == true %>
          <div class="btn btn-outline-success">Accepted!</div>
          <%# Bootstrap %>
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal<%=counter%>">
            Set up a meeting
          </button>
          <%= render 'meetings/popup', counter: counter, request: request %>
          <%# Bootstrap %>
          <%# Check if there is a meeting already set%>
          <% meetings = Meeting.where(connection_id: request) %>
          <% connection_meetings = meetings.where(meeting_pending: false) %>
          <%= render 'show_meetings', connection_meetings: connection_meetings, request: request, counter: counter %>
        <% elsif request.pending == false && request.accepted == false %>
          <div class="btn btn-outline-danger">Declined!</div>
        <% end %>
      <% end %>
    <% end %>
  </div>

  <div class="requests">
    <h1>Requests I've sent</h1>
    <% counter = 0 %>
    <% @my_connection_requests_sent.each do |request| %>
      <% counter += 1 %>
      <p>Company name: <%= User.where(id:request.receiver_id).select(:company_name).first.company_name %></p>
      <% if request.pending == true %>
        <div class="btn btn-outline-warning">Pending</div>
      <% else %>
        <% if request.pending == false && request.accepted == true %>

          <div class="btn btn-outline-success">Accepted!</div>
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal<%=counter%>">
            Set up a meeting
          </button>
          <%= render 'meetings/popup', counter: counter, request: request %>
          <% meetings = Meeting.where(connection_id: request) %>
          <% connection_meetings = meetings.where(meeting_pending: false) %>
          <%= render 'show_meetings', connection_meetings: connection_meetings, request: request, counter:counter %>
        <% elsif request.pending == false && request.accepted == false %>
          <div class="btn btn-outline-danger">Declined!</div>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
